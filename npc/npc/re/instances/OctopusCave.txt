//===== Hercules Script ======================================
//= Octopus Cave
//===== By: =========Translation:============================= 
//= Muad_Dib         °²ºÕ¶û|20130702[ROSF.US]
//===== Current Version: =====================================
//= 1.1
//===== Description: =========================================
//= [Official Conversion]
//= Defeat the Disgusting Octopus.
//===== Additional Comments: =================================
//= 1.0 First version. [Euphy]
//= 1.1 Instance system rewrite. [Euphy]
//============================================================

1@cash	mapflag	src4instance
//============================================================

// Instance Creation
//============================================================
mal_dun01,151,235,5	script	º£ĞÇ	551,{

	set .@party_id,getcharid(1);
	set .@md_name$,"°Ë×¦Óã³²Ñ¨";

	if (!.@party_id) {
		mes "[º£ĞÇ]";
		mes "¹ÂÉíÒ»ÈËÊÇÃ»ÓÃµÄ, ºÇºÇ!";
		mes "ÕÒĞ©Ö¾Í¬µÀºÏµÄÈËÀ´°ïÄã°Ñ.";
		mes "×é³ÉÒ»Ö§¶ÓÎé, È»ºóÔÙÀ´ÕÒÎÒ.";
		close;
	}
	if (getcharid(0) != getpartyleader(.@party_id,2)) {
		mes "[º£ĞÇ]";
		mes "ÄãÃÇµÄ¶Ó³¤ÔÚÄÄÀï, ºÇºÇ.";
		mes "ÎÒ¿É²»ÊÇ¸öËæ±ãµÄÈË,";
		mes "°ÑÄãÃÇÍ·½ĞÀ´.";
		close;
	}
	mes "[º£ĞÇ]";
	mes "ÎÒÔÚÕâÀïÊØ×Å, ºÇºÇ!";
	mes "ÏÖÔÚ°Ë×¦ÓãµÄ¶´Ñ¨Ö»ÊÇÁÙÊ±±»¶ÂËÀÁË.";
	mes "²»¹ıÎÒ¾õµÃÀëËüÓÀÔ¶±»·âµÄÈÕ×Ó²»Ô¶ÁË, ºÇºÇ!";
	next;
	while(1) {
		switch(select("- Ñ¯ÎÊ·¢ÉúÁËÊ²Ã´.:- ÒªÇó´ò¿ª¶´¿Ú.:- È¥±ğµÄµØ·½.")) {
		case 1:
			mes "[º£ĞÇ]";
			mes "×î½ü, ÎÒÃÇº£ĞÇÒ»×åµÄÅ®Íõ";
			mes "Åöµ½ÁËÒ»Ğ©Âé·³, àëàë.";
			mes "Ò»Ğ©²»Óä¿ìµÄÊÂÇé´òÆÆÁËÕâ¸ö";
			mes "µØ·½µÄÄş¾², ºÇºÇ!";
			next;
			mes "[º£ĞÇ]";
			mes "´ÓÎÒ±³ºóµÄ¶´Àï³öÀ´ºÜ¶à";
			mes "°Ë×¦ÓãµÄ´¥ÊÖ,";
			mes "ÕâĞ©¹í¶«Î÷ÊÔÍ¼°ó¼ÜÎÒÃÇº£ĞÇ.";
			mes "Ò»×åµÄÅ®Íõ, àŞàŞ.";
			next;
			mes "[º£ĞÇ]";
			mes "ÕâĞ©¶ñĞÄµÄ´¥ÊÖ¶¼ÊÇÊôÓÚÄÇ¸ö";
			mes "¸ÃËÀµÄ°Ë×¦ÓãµÄ.";
			mes "Õâ¸ö¼Ò»ïÓ¦¸Ã±»ºÃºÃµÄĞŞÀíÒ»ÏÂ,";
			mes "²»¹ıÕâ¸ö¶ÔÓÚÎÒÃÇÈõĞ¡µÄº£ĞÇÒ»×åÀ´ËµÊÇ·Ç³£ÓĞÄÑ¶ÈµÄ, ºÇºÇ.";
			next;
			mes "[º£ĞÇ]";
			mes "ÎÒĞèÒªÓĞÒ»Ğ©×¨ÒµµÄÈË,";
			mes "À´ºÃºÃ½ÌÑµÕâÖ»°Ë×¦Óã.";
			mes "ÈÃËüÒÔºóÔÙÒ²²»¸Ò´òÎÒÃÇÅ®ÍõµÄÖ÷Òâ.";
			mes "ºÇºÇ.";
			next;
			mes "[º£ĞÇ]";
			mes "È¥°ÎµôËüµÄ´¥ÊÖ, ²¢°ÑËüÃÇ×ö³É±ê±¾.";
			mes "Èç¹ûÄãÄÜ¹»³ĞÅµ´ø»ØÒ»Ğ©ÕâÑùµÄÕ½ÀûÆ·, ";
			mes "ÎÒ¾Í´ò¿ª±³ºóµÄ¶´ÃÅ.";
			mes "ÈÃÄãÄÜ¹»½øÈ¥Ì½ÏÕ, ºÇºÇ.";
			next;
			break;
		case 2:
			set .@playtime, checkquest(4197,PLAYTIME);
			if (.@playtime == 0 || .@playtime == 1) {
				mes "[º£ĞÇ]";
				mes "ÄÇÖ»°Ë×¦Óã²»ÔÚ¸½½ü, ºÇºÇ.";
				mes "ÇëÉÔºòÔÙÀ´.";
				close;
			}
			if (.@playtime == 2) erasequest 4197;
			if (countitem(6442)) {
				set .@instance,instance_create(.@md_name$,.@party_id);
				if (.@instance < 0) {
					mes "[º£ĞÇ]";
					mes "¶ÓÎéÃûÊÇ... "+getpartyname(.@party_id)+".";
					mes "¶Ó³¤... "+strcharinfo(0)+".";
					mes "^0000ff"+.@md_name$+"^000000, ÏÖÔÚÎÒ¿ÉÃ»·¨´ò¿ª¶´ÃÅ, ºÇºÇ.";
					mes "Ê±»ú²»¶Ô, ÇëÔÙµÈµÈ.";
					close;
				}
				if (instance_attachmap("1@cash",.@instance) == "") {
					mes "^0000ff"+.@md_name$+"^000000 - ×¢²áÊ§°Ü!";
					instance_destroy(.@instance);
					close;
				}
				instance_set_timeout 3600,300,.@instance;
				instance_init(.@instance);
				
				mes "[º£ĞÇ]";
				mes "ÎÒ»á´ò¿ªÍ¨Ïò ^0000ff"+.@md_name$+"^000000µÄ´óÃÅ.";
				mes "ÇëÎñ±ØÒª½ÌÑµÕâÖ»ºÃÉ«µÄ°Ë×¦Óã,";
				mes "»òÕß´ø»ØÒ»Ğ©ËüµÄ´¥½Ç, ºÙºÙ.";
				close;
			}
			mes "[º£ĞÇ]";
			mes "×¼±¸ºÃ²¶ÕÂÓã¹÷,";
			mes "ÓĞÁËËüÎÒ²ÅÄÜ·ÅÄã½øÈ¥.";
			mes "¿ìÈ¥×¼±¸°É.";
			mes "È»ºó, ÎÒ»áÈÃÄã½øÈ¥Ò»»á, ºÇºÇ.";
			close;
		case 3:
			mes "[º£ĞÇ]";
			mes "Õâ²»ÊÇ¸öºÃµØ·½, ÊÔÊÔ¼ì²é±ğµÄµØ·½.";
			close;
		}
	}
}

mal_dun01,153,237,5	script	¹ÖÒìµÄÈë¿Ú	844,{
	mes "ÕâÀïÓĞ¸ö¹ÖÒìµÄÈë¿Ú.";
	mes "±»Ò»Ğ©Ä¾°å¸ø¶ÂËÀÁË.";
	next;
	switch(select("- ½øÈë.:- Í£ÏÂ.")) {
	case 1:
		if (countitem(6442)) {
			if (has_instance("1@cash") == "") {
				if (checkquest(4197,PLAYTIME) == 0 || checkquest(4197,PLAYTIME) == 1) {
					mes "[Starfish]";
					mes "Ah, now is not the time...";
					mes "Would you come back later? Hehe.";
					close;
				}
				mes "[Starfish]";
				mes "Shhh... Weird aura is";
				mes "coming from that entrance.";
				mes "Big trouble is waiting, if you go in now.";
				close;
			}
			mapannounce "mal_dun01", getpartyname(getcharid(1))+" party's "+strcharinfo(0)+" member started to hunt the Octopus!",bc_map,"0x00ff99";
			if (checkquest(4197) == -1) setquest 4197;
			warp "1@cash",199,99;
			end;
		}
		mes "[º£ĞÇ]";
		mes "Èç¹ûÄãÒª°ïÎÒÃÇ½ÌÑµÕâÖ»É«ÀÇÕÂÓãµÄ»°";
		mes "Ò»¶¨Òª×öºÃ³ä·ÖµÄ×¼±¸.";
		mes "¼ÇµÃ´øÉÏá÷ÁÔ°ô.";
		mes "²»È»ÎÒ¿É²»»áÈÃÄã½øÈ¥! ºÇºÇ.";
		close;
	case 2:
		mes "[º£ĞÇ]";
		mes "ÊÇµÄÊÇµÄ, Äã×îºÃ±ğÂÒ½ÁºÍ.";
		close;
	}
}

// Instance Scripts
//============================================================
1@cash,199,99,0	script	oct_enter	139,4,4,{
	end;
OnTouch:
	donpcevent instance_npcname("oct_enter_broad")+"::OnEnable";
	specialeffect EF_BASH;
	disablenpc instance_npcname("oct_enter");
	end;
}

1@cash,1,1,0	script	oct_enter_broad	-1,{
	end;
OnInstanceInit:
	donpcevent instance_npcname("oct_enter_broad")+"::OnDisable";
	end;
OnEnable:
	enablenpc instance_npcname("oct_enter_broad");
	donpcevent instance_npcname("oct_foot_4")+"::OnEnable";
	donpcevent instance_npcname("oct_mob_con")+"::OnEnable";
	initnpctimer;
	end;
OnDisable:
	disablenpc instance_npcname("oct_enter_broad");
	end;
OnTimer1000:
	mapannounce instance_mapname("1@cash"),"É«ÀÇ°Ë×¦Óã : ÄãÔõÃ´¸Ò½øÀ´ÎÒµÄµØÅÌ!",bc_map,"0xFFFF00";
	end;
OnTimer4000:
	mapannounce instance_mapname("1@cash"),"É«ÀÇ°Ë×¦Óã : ÈÃÎÒ¶ÂÉÏËùÓĞµÄÍ¨µÀ!! ¸ãµÃÄãÃ»·½Ïò!",bc_map,"0xFFFF00";
	end;
OnTimer7000:
	mapannounce instance_mapname("1@cash"),"É«ÀÇ°Ë×¦Óã : ¶ùËïÃÇ~ ÕâÀïÓĞ¸öÄú°®ÍæµÄ¶«Î÷! ºÃºÃºÍËûË£Ë£~ ÍÛßÇßÇ",bc_map,"0xFFFF00";
	stopnpctimer;
	donpcevent instance_npcname("oct_enter_broad")+"::OnDisable";
	end;
}

1@cash,3,3,0	script	oct_foot_4	-1,{
	end;
OnInstanceInit:
	donpcevent instance_npcname("oct_foot_4")+"::OnDisable";
	end;
OnEnable:
	enablenpc instance_npcname("oct_foot_4");
	donpcevent instance_npcname("oct_foot1")+"::OnEnable";
	donpcevent instance_npcname("oct_foot2")+"::OnEnable";
	donpcevent instance_npcname("oct_foot3")+"::OnEnable";
	donpcevent instance_npcname("oct_foot4")+"::OnEnable";
	set .@map$, instance_mapname("1@cash");
	monster .@map$,20,114,"ÕÂÓã´¥Ğë#1",2193,1,instance_npcname("oct_foot_4")+"::OnMyMobDead";
	monster .@map$,88,190,"ÕÂÓã´¥Ğë#2",2193,1,instance_npcname("oct_foot_4")+"::OnMyMobDead";
	monster .@map$,307,215,"ÕÂÓã´¥Ğë#3",2193,1,instance_npcname("oct_foot_4")+"::OnMyMobDead";
	monster .@map$,372,131,"ÕÂÓã´¥Ğë#4",2193,1,instance_npcname("oct_foot_4")+"::OnMyMobDead";
	end;
OnDisable:
	disablenpc instance_npcname("oct_foot_4");
	end;
OnMyMobDead:
	set .@map$, instance_mapname("1@cash");
	if (mobcount(.@map$,instance_npcname("oct_foot_4")+"::OnMyMobDead") < 1) {
		donpcevent instance_npcname("oct_boss_con")+"::OnEnable";
		mapannounce .@map$,"ºÙĞ¡×Ó!! ÎÒ»áÇ×ÊÖÁÏÀíÄãÃÇÕâ°ï¼Ò»ï! Let's bring it on!",bc_map,"0x00ff99";
		enablenpc instance_npcname("oct_boss_warp");
		instance_warpall .@map$,199,99;
		end;
	}
	mapannounce .@map$,"ÎÒÈÕ!! ÊÜÉËÁË!!! ÎÒĞèÒª¸Ä±ä½ø¹¥²ßÂÔ...",bc_map,"0x00ff99";
	end;
}

1@cash,20,114,0	script	oct_foot1	139,6,6,{
	end;
OnInstanceInit:
	donpcevent instance_npcname(strnpcinfo(0))+"::OnDisable";
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0));
	set .@label$, instance_npcname(strnpcinfo(0))+"::OnMyMobDead";
	set .@i, atoi(charat(strnpcinfo(0),8));
	set .@map$, instance_mapname("1@cash");
	switch(.@i) {
	case 1:
		areamonster .@map$,34,96,38,100,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,39,90,41,92,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,38,76,40,78,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,39,58,41,60,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,50,38,56,44,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,68,32,72,36,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,83,26,85,28,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,107,28,109,30,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1,.@label$;
		areamonster .@map$,123,28,125,30,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,134,31,138,35,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,142,39,146,43,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		break;
	case 2:
		areamonster .@map$,139,113,143,117,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,135,104,137,106,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,123,93,127,97,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,113,90,115,92,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,103,89,105,91,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,89,90,91,92,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,74,104,76,106,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,74,120,76,122,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,83,131,87,135,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,92,142,94,144,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,98,159,100,161,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,94,180,98,184,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		break;
	case 3:
		areamonster .@map$,299,209,303,213,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,292,203,296,207,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,291,186,293,188,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,292,166,294,168,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,293,151,295,153,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,299,137,303,141,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,300,123,304,127,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,300,104,304,108,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,279,101,281,103,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		monster .@map$,260,103,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1,.@label$;
		break;
	case 4:
		areamonster .@map$,363,123,367,127,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,364,108,368,112,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,363,93,367,97,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,364,72,366,74,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,364,58,366,60,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,355,44,359,48,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,346,36,350,40,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,319,28,325,34,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,305,27,307,29,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		areamonster .@map$,276,29,280,33,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,.@label$;
		areamonster .@map$,258,37,262,41,"°Ë×¦ÓãµÄĞÄ¸¹",2192,2,.@label$;
		break;
	}
	end;
OnDisable:
	killmonster instance_mapname("1@cash"),instance_npcname(strnpcinfo(0))+"::OnMyMobDead"; // Not in official script.
	disablenpc instance_npcname(strnpcinfo(0));
	end;
OnTouch:
	if (getd("."+strnpcinfo(0)+instance_id())) end;
	setd "."+strnpcinfo(0)+instance_id(),1;
	hideonnpc instance_npcname(strnpcinfo(0));
	mapannounce instance_mapname("1@cash"),"Come out all my babies and help me out!",bc_map,"0xFFFF00";
	initnpctimer;
	end;
OnTimer5000:
	set .@map$, instance_mapname("1@cash");
	mapannounce .@map$,"Let's give them a lesson!",bc_map,"0xFFFF00";
	set .@label$, instance_npcname(strnpcinfo(0))+"::OnMyMobDead";
	set .@i, atoi(charat(strnpcinfo(0),8));
	switch(.@i) {
	case 1:
		areamonster .@map$,18,112,22,116,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,18,112,22,116,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		break;
	case 2:
		areamonster .@map$,86,188,90,192,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,96,98,100,102,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		break;
	case 3:
		areamonster .@map$,305,213,309,217,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,305,213,309,217,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		break;
	case 4:
		areamonster .@map$,370,129,374,133,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		areamonster .@map$,370,129,374,133,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3,.@label$;
		break;
	}
	end;
OnTimer30000:
	setd "."+strnpcinfo(0)+instance_id(),0;
	stopnpctimer;
	set .@i, atoi(charat(strnpcinfo(0),8));
	donpcevent instance_npcname("oct_foot_exit"+.@i)+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0))+"::OnDisable";
	end;
OnMyMobDead:
	set .@map$, instance_mapname("1@cash");
	if (mobcount(.@map$,instance_npcname(strnpcinfo(0))+"::OnMyMobDead") < 1) {
		mapannounce .@map$,"Äã¾¹¸ÒÉËÁËÎÒµÄ¶ùËïÃÇ!!? Äã»áÎª´Ë¸¶³ö´ú¼ÛµÄ!!!",bc_map,"0x00ff99";
		setd "."+strnpcinfo(0)+instance_id(),0;
		stopnpctimer;
		set .@i, atoi(charat(strnpcinfo(0),8));
		donpcevent instance_npcname("oct_foot_exit"+.@i)+"::OnEnable";
		donpcevent instance_npcname(strnpcinfo(0))+"::OnDisable";
		end;
	}
	end;
}
1@cash,88,190,0	duplicate(oct_foot1)	oct_foot2	139,6,6
1@cash,307,215,0	duplicate(oct_foot1)	oct_foot3	139,6,6
1@cash,372,131,0	duplicate(oct_foot1)	oct_foot4	139,6,6

1@cash,16,117,0	script	oct_foot_exit1	45,2,2,{
	end;
OnInstanceInit:
	disablenpc instance_npcname(strnpcinfo(0));
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0));
	end;
OnTouch:
	warp instance_mapname("1@cash"),198,99;
	end;
}
1@cash,77,193,0	duplicate(oct_foot_exit1)	oct_foot_exit2	45,2,2
1@cash,312,214,0	duplicate(oct_foot_exit1)	oct_foot_exit3	45,2,2
1@cash,370,139,0	duplicate(oct_foot_exit1)	oct_foot_exit4	45,2,2

1@cash,15,15,0	script	oct_mob_con	-1,{
	end;
OnInstanceInit:
	donpcevent instance_npcname("oct_mob_con")+"::OnDisable";
	end;
OnEnable:
	set .@map$, instance_mapname("1@cash");
	enablenpc instance_npcname("oct_mob_con");
	monster .@map$,32,94,"º?û",1068,1;
	monster .@map$,41,101,"º?û",1068,1;
	monster .@map$,35,78,"º?û",1068,1;
	monster .@map$,35,62,"º?û",1068,1;
	monster .@map$,49,54,"º?û",1068,1;
	monster .@map$,70,28,"º?û",1068,1;
	monster .@map$,83,22,"º?û",1068,1;
	monster .@map$,99,23,"º?û",1068,1;
	monster .@map$,115,23,"º?û",1068,1;
	monster .@map$,132,25,"º?û",1068,1;
	monster .@map$,100,185,"º?û",1068,1;
	monster .@map$,92,178,"º?û",1068,1;
	monster .@map$,92,162,"º?û",1068,1;
	monster .@map$,70,121,"º?û",1068,1;
	monster .@map$,70,105,"º?û",1068,1;
	monster .@map$,105,85,"º?û",1068,1;
	monster .@map$,121,84,"º?û",1068,1;
	monster .@map$,292,209,"º?û",1068,1;
	monster .@map$,303,206,"º?û",1068,1;
	monster .@map$,290,163,"º?û",1068,1;
	monster .@map$,299,150,"º?û",1068,1;
	monster .@map$,308,141,"º?û",1068,1;
	monster .@map$,308,125,"º?û",1068,1;
	monster .@map$,295,97,"º?û",1068,1;
	monster .@map$,279,97,"º?û",1068,1;
	monster .@map$,370,111,"º?û",1068,1;
	monster .@map$,370,110,"º?û",1068,1;
	monster .@map$,371,96,"º?û",1068,1;
	monster .@map$,371,80,"º?û",1068,1;
	monster .@map$,367,55,"º?û",1068,1;
	monster .@map$,343,29,"º?û",1068,1;
	monster .@map$,327,24,"º?û",1068,1;
	monster .@map$,311,22,"º?û",1068,1;
	monster .@map$,295,22,"º?û",1068,1;
	monster .@map$,279,22,"º?û",1068,1;
	areamonster .@map$,30,67,50,87,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,102,19,122,39,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,89,138,109,158,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,112,83,132,103,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,283,168,303,188,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,292,97,312,117,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,355,64,375,84,"Ê¯Í·²¨Àû",1784,1;
	areamonster .@map$,317,17,337,37,"Ê¯Í·²¨Àû",1784,1;
	donpcevent instance_npcname("oct_backattack1")+"::OnEnable";
	donpcevent instance_npcname("oct_backattack2")+"::OnEnable";
	donpcevent instance_npcname("oct_backattack3")+"::OnEnable";
	donpcevent instance_npcname("oct_backattack4")+"::OnEnable";
	donpcevent instance_npcname("oct_mob_con")+"::OnDisable";
	end;
OnDisable:
	disablenpc instance_npcname("oct_mob_con");
	end;
}

1@cash,45,53,0	script	oct_backattack1	139,3,3,{
	end;
OnInstanceInit:
	disablenpc instance_npcname("oct_backattack1");
	end;
OnTouch:
	set .@map$, instance_mapname("1@cash");
	monster .@map$,39,59,"º?û",1068,1;
	monster .@map$,40,59,"º?û",1068,1;
	monster .@map$,41,59,"º?û",1068,1;
	monster .@map$,47,50,"º?û",1068,1;
	monster .@map$,48,50,"º?û",1068,1;
	monster .@map$,49,50,"º?û",1068,1;
	monster .@map$,41,53,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	mapannounce .@map$,"²»ÒªÈÃËûÃÇÍ»ÆÆÍ¨µÀ, ÖÆÖ¹ËûÃÇ!!!",bc_map,"0x00ff99";
	specialeffect EF_BASH;
	disablenpc instance_npcname("oct_backattack1");
	end;
OnEnable:
	enablenpc instance_npcname("oct_backattack1");
	end;
}

1@cash,78,99,0	script	oct_backattack2	139,3,3,{
	end;
OnInstanceInit:
	disablenpc instance_npcname("oct_backattack2");
	end;
OnTouch:
	if (getd("."+instance_id())) end;
	setd "."+instance_id(),1;
	initnpctimer;
	set .@map$, instance_mapname("1@cash");
	monster .@map$,71,105,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	mapannounce .@map$,"ÀÏ¼Ò¿ÕĞé, ¿ì×ß!!!",bc_map,"0x00ff99";
	hideonnpc instance_npcname("oct_backattack2");
	end;
OnTimer2000:
	set .@map$, instance_mapname("1@cash");
	monster .@map$,71,105,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	mapannounce .@map$,"ËÙ¶È, ËÙ¶È! ¿ì, ¿ì!!!",bc_map,"0x00ff99";
	end;
OnTimer4000:
	set .@map$, instance_mapname("1@cash");
	monster .@map$,71,105,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	mapannounce .@map$,"Ã»Ê±¼äÁË, ¿ì³öÀ´!",bc_map,"0x00ff99";
	end;
OnTimer6000:
	set .@map$, instance_mapname("1@cash");
	monster .@map$,71,105,"°Ë×¦ÓãµÄĞÄ¸¹",2192,3;
	mapannounce .@map$,"ÎÒÃÇÈ¥Õ¼ËüÃÇÀÏ¼Ò!!!",bc_map,"0x00ff99";
	end;
OnTimer8000:
	set .@map$, instance_mapname("1@cash");
	monster .@map$,71,105,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	mapannounce .@map$,"Ã»Ê±¼äÔÙÀË·ÑÁË, ËÙ¶È!!!!",bc_map,"0x00ff99";
	stopnpctimer;
	end;
OnEnable:
	enablenpc instance_npcname("oct_backattack2");
	end;
}

1@cash,299,144,0	script	oct_backattack3	139,3,3,{
	end;
OnInstanceInit:
	disablenpc instance_npcname("oct_backattack3");
	end;
OnTouch:
	if (getd("."+instance_id())) end;
	setd "."+instance_id(),1;
	set .@map$, instance_mapname("1@cash");
	monster .@map$,293,153,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,294,152,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,292,153,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,293,151,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,293,152,"°Ë×¦ÓãµÄĞÄ¸¹ ?",2175,1;
	mapannounce .@map$,"ÍÛ¸Â¸Â! ³Ô¾ªÂğ??!!",bc_map,"0x00ff99";
	initnpctimer;
	hideonnpc instance_npcname("oct_backattack3");
	end;
OnTimer5000:
	mapannounce instance_mapname("1@cash"),"... ¿´ÆğÀ´ÔÚÎÒÃÇÖĞ¼äÓĞ¸ö¼äµı.",bc_map,"0x00ff99";
	stopnpctimer;
	end;
OnEnable:
	enablenpc instance_npcname("oct_backattack3");
	end;
}

1@cash,336,36,0	script	oct_backattack4	139,3,3,{
	end;
OnInstanceInit:
	disablenpc instance_npcname("oct_backattack4");
	end;
OnTouch:
	if (getd("."+instance_id())) end;
	setd "."+instance_id(),1;
	set .@map$, instance_mapname("1@cash");
	monster .@map$,332,37,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,332,36,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,332,35,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,332,34,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,341,37,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,341,36,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,341,35,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,341,34,"°Ë×¦ÓãµÄĞÄ¸¹",2192,1;
	monster .@map$,260,40,"ÎÚÔôÓ¶±ø",2175,1;
	monster .@map$,260,41,"ÎÚÔôÓ¶±ø",2175,1;
	monster .@map$,260,39,"ÎÚÔôÓ¶±ø",2175,1;
	monster .@map$,259,40,"ÎÚÔôÓ¶±ø",2175,1;
	monster .@map$,261,40,"ÎÚÔôÓ¶±ø",2175,1;
	mapannounce .@map$,"Ò»´ÎÆ¯ÁÁµÄ¼Ğ»÷Õ½Êõ! µĞÈË·Ç³£Ç¿º·! ²»Òªµ£ĞÄ! ×ÜÖ®, ÕâÀïµ½´¦¶¼ÊÇÓ¶±ø??",bc_map,"0x00ff99";
	initnpctimer;
	hideonnpc instance_npcname("oct_backattack4");
	end;
OnTimer5000:
	mapannounce instance_mapname("1@cash"),"ÎÚÔôÓ¶±ø : ßÀ...ßÀ... ×ß´íÁË·½Ïò. ÔÚÕâ¸ö·½ÏòÃ»ÓĞµĞÈË.",bc_map,"0x00ff99";
	end;
OnTimer7000:
	mapannounce instance_mapname("1@cash"),"É«ÀÇ°Ë×¦Óã : ´À»õÉÏµ±ÁË! ÄÑµÀÄã²»¿´µØÍ¼??!! Useless!!",bc_map,"0x00ff99";
	stopnpctimer;
	end;
OnEnable:
	enablenpc instance_npcname("oct_backattack4");
	end;
}

1@cash,2,2,0	script	oct_boss_con	-1,{
	end;
OnInstanceInit:
	donpcevent instance_npcname("oct_boss_con")+"::OnDisable";
	end;
OnDisable:
	disablenpc instance_npcname("oct_boss_con");
	end;
OnEnable:
	enablenpc instance_npcname("oct_boss_con");
	donpcevent instance_npcname("oct_boss_foot")+"::OnEnable";
	monster instance_mapname("1@cash"),199,188,"¶ñĞÄµÄ°Ë×¦Óã",2194,1,instance_npcname("oct_boss_con")+"::OnMyMobDead";
	initnpctimer;
	end;
OnTimer7000:
	callsub OnAnnounce,
		"Äã²»ÄÜ¹¥»÷ÈËÀà.",
		"ÎÒÉÏÖÜ±»Ä«Ë®µê¸ø½â¹ÍÁË.",
		"¶ñĞÄµÄ°Ë×¦Óã : °¡¸Â¸Â, À´°É!";
	end;
OnTimer14000:
	callsub OnAnnounce,
		"ÎªÊ²Ã´...ÄãÎªÊ²Ã´²»ÄÜÃ÷°×ÎÒµÄĞÄ!",
		"ÄãÖªµÀÊÇ¶àÃ´Í´¿àµÄÒ»¶ÎÊ±¹â,ÒòÎª²»»áÓĞÌ«¶àĞÂµÄÃ°ÏÕ?",
		"Äã..ÎÒÒªÃğÁËÄã...!";
	end;
OnTimer21000:
	callsub OnAnnounce,
		"Ê²Ã´? ÎÒÊÇÒ»¸ö¶ñĞÄÕÂÓã? ÄãÊÇÅ°´ı¿ñ.",
		"ÎÒÃÇÕâÑù×ö,ÈÃÎÒÃÇÀ´¿´¿´×î¼Ñ½â¾ö·½°¸,ºÇºÇ??",
		"¾ÍËãÎÒÊ§°ÜÁË,ÎÒ»¹»á¼ÌĞø»ØÀ´,Ö±µ½ÓÀÔ¶!!!";
	end;
OnTimer28000:
	callsub OnAnnounce,
		"½»ÅäÊÇÄĞĞÔµÄ±¾ÄÜ,ÎÒÓĞÊ²Ã´´í?",
		"ÄÑµÀÄãÕæµÄÏëÒªÈ¥½â¾öÕâ¸öÎÊÌâ,ÈËÓëÈËÖ®¼äÊÇÇ¿¼é? °¡¹ş¹ş,ÎÒÊÇÕÂÓã...",
		"¹»ÁË,ÉÁ¿ª!";
	end;
OnTimer35000:
	callsub OnAnnounce,
		"ÄÑµÀÎÒÓÖÒ»´ÎÒªÔÙ´Îµ¥¶À¶È¹ıÊ¥µ®½Ú...",
		"ÇàÄê¾ÍÒµÎÊÌâ³ÉÎªÒ»¸öºÜ´óµÄÂé·³,Èç¹ûÄã¼ÌĞøÔÚÕâÀï¸úÎÒÍæ,Äã½«Ò»Ö±²»»áµÃµ½Ò»·İ¹¤×÷.",
		"Õâ¾ÍÊÇµ½Ä¿Ç°ÎªÖ¹,ÎÒ»¹¿ÉÒÔ¼ÌĞø!";
	end;
OnTimer42000:
	callsub OnAnnounce,
		"µ±ÄãÏëÆğÄ³ÈËµÄÊ±ºò,Äã¿ÉÒÔ°ÑÊÖ·ÅÔÚĞØÇ°È»ºóÆíµ»...",
		"ÎÒÃÇ²»ÒªÔÚÕâÀï×öÕâÊÂ,Òª°´ÕÕ·¨ÂÉÁ÷³ÌÀ´×ö!",
		"Äã»á¼ÌĞøÕâÑù×öÖ±µ½×îºó,ÊÇÂğ?";
	end;
OnTimer49000:
	callsub OnAnnounce,
		"errrrrrrrrrrrrrrrrrrrrrrrr... ¿ÈËÔ! ¿ÈËÔ!",
		"¶ñĞÄµÄ°Ë×¦Óã : ÎŞÂÛÈçºÎ,±©Á¦¶¼²»µÃÊÓÎªÕıµ±.",
		"ÕâÊÇÎÒµÄµØÅÌ!!!";
	stopnpctimer;
	initnpctimer;
	end;
OnAnnounce:
	mapannounce instance_mapname("1@cash"),"¶ñĞÄµÄ°Ë×¦Óã : "+getarg(rand(3)),bc_map,"0xFFFF00";
	return;
OnMyMobDead:
	set .@map$, instance_mapname("1@cash");
	if (mobcount(.@map$,instance_npcname("oct_boss_con")+"::OnMyMobDead") < 1) {
		mapannounce .@map$,"¶ñĞÄµÄ°Ë×¦Óã : ¾ÍÊÇËü½ñÌìÔã¸âµÄ±íÏÖ! ÏÂÒ»´Î,ÈÃÎÒÀ´ºÍÄãÍæÍæ, ÈçºÎ?",bc_map,"0xFFFF00";
		enablenpc instance_npcname("oct_exit_1");
		enablenpc instance_npcname("oct_exit_2");
		donpcevent instance_npcname("oct_boss_foot")+"::OnDisable";
		stopnpctimer;
		donpcevent instance_npcname("oct_boss_con")+"::OnDisable";
		end;
	}
	end;
}

1@cash,4,4,0	script	oct_boss_foot	-1,{
	end;
OnInstanceInit:
	donpcevent instance_npcname("oct_boss_foot")+"::OnDisable";
	end;
OnEnable:
	enablenpc instance_npcname("oct_boss_foot");
	initnpctimer;
	end;
OnCall:
	set .@map$, instance_mapname("1@cash");
	if (mobcount(.@map$,instance_npcname("oct_boss_foot")+"::OnMyMobDead") < 100) {
		switch(rand(2)) {
		case 0:
			mapannounce .@map$,"¶ñĞÄµÄ°Ë×¦Óã : ÄãÏëÖªµÀÕÂÓãÓĞ¶àÉÙÌõÍÈ? Ã»¹ØÏµ,ÎÒÓĞÎŞÏŞµÄÍÈ!!",bc_map,"0xFFFF00";
			areamonster .@map$,192,181,206,195,"°Ë×¦ÓãµÄÍÈ",2193,1,instance_npcname("oct_boss_foot")+"::OnMyMobDead";
			break;
		case 1:
			mapannounce .@map$,"¶ñĞÄµÄ°Ë×¦Óã : ÎÒ...¶¥²»×¡..¸ü¶àµÄÁË, ÎÒµÄº¢×ÓÃÇ~ ³öÀ´Õ½¶·°É!",bc_map,"0xFFFF00";
			areamonster .@map$,192,181,206,195,"°Ë×¦ÓãµÄĞÄ¸¹",2192,5,instance_npcname("oct_boss_foot")+"::OnMyMobDead";
			break;
		}
	}
	initnpctimer;
	end;
OnTimer10000:
	stopnpctimer;
	donpcevent instance_npcname("oct_boss_foot")+"::OnCall";
	end;
OnDisable:
	stopnpctimer;
	killmonster instance_mapname("1@cash"),instance_npcname("oct_boss_foot")+"::OnMyMobDead"; // Not in official script.
	disablenpc instance_npcname("oct_boss_foot");
	end;
OnMyMobDead:
	end;
}

1@cash,198,116,0	script	oct_boss_warp	45,2,2,{
	end;
OnInstanceInit:
	disablenpc instance_npcname("oct_boss_warp");
	end;
OnTouch:
	warp instance_mapname("1@cash"),210,172;
	end;
}

1@cash,190,208,0	script	oct_exit_1	45,2,2,{
	end;
OnInstanceInit:
	disablenpc instance_npcname(strnpcinfo(0));
	end;
OnTouch:
	mes "ÄãÏëÀë¿ª°Ë×¦Óã³²Ñ¨¸±±¾Âğ?";
	next;
	if(select("- ²»!:- ÊÇ!") == 2)
		warp "mal_dun01",153,233;
	close;
}
1@cash,198,82,0	duplicate(oct_exit_1)	oct_exit_2	45,2,2
// This is never enabled in the official script.
//1@cash,200,161,0	duplicate(oct_exit_1)	oct_exit_3	45,2,2

// Warp Portals
//============================================================
1@cash,193,82,0	warp	oct_door1	2,2,1@cash,151,48
1@cash,154,53,0	warp	oct_door2	2,2,1@cash,197,87
1@cash,187,99,0	warp	oct_door3	2,2,1@cash,148,128
1@cash,153,133,0	warp	oct_door4	2,2,1@cash,197,99
1@cash,209,100,0	warp	oct_door5	2,2,1@cash,250,111
1@cash,244,118,0	warp	oct_door6	2,2,1@cash,199,100
1@cash,209,83,0	warp	oct_door7	2,2,1@cash,252,46
1@cash,246,53,0	warp	oct_door8	2,2,1@cash,203,83
